$(document).on("touchmove",function(a){a.preventDefault()});$(function(){var c=$(".xy-loading"),d=$(".loading"),g=false,b=0,k=$("#main .view").length,i=$(".gift-box");var e={0:function(u){var n=$(".view-1");var t=n.find(".photo-1");var s=n.find(".photo-2");var r=n.find(".photo-3");var q=n.find(".text-1");var p=n.find(".text-2");var o=n.find(".text-3");setTimeout(function(){new a(q[0],function(){$("#sound").fadeIn();new a(p[0],function(){new a(o[0],function(){t.addClass("active");setTimeout(function(){s.addClass("active")},600);setTimeout(function(){r.addClass("active");console.log(g,u);u&&u()},1200)})})})},800)},1:function(o){var n=$(".view-1");n.fadeOut(800,function(){var s=$(".view-2");var r=s.find(".photo-box-1");var p=s.find(".photo-box-2");var u=s.find(".photo-box-3");var t=s.find(".photo");t.on("transitionEnd webkitTransitionEnd",function(v){v.stopPropagation()});r.addClass("active");function q(){var w=$(this);var v=w.find(".photo");var x=w.find(".text");v.addClass("active");new a(x[0],function(){v.addClass("active")})}r.on("transitionEnd webkitTransitionEnd",q);setTimeout(function(){p.addClass("active");p.on("transitionEnd webkitTransitionEnd",q)},1200);setTimeout(function(){u.addClass("active");u.on("transitionEnd webkitTransitionEnd",function(){q.call(this);o&&o()})},2400)})},2:function(n){$(".view-2").fadeOut(400,function(){var o=$(".view-3");var t=o.find(".photo-1");var s=o.find(".photo-2");var r=o.find(".text-1");var q=o.find(".text-2");var p=o.find(".text-3");new a(r[0],function(){new a(q[0],function(){new a(p[0],function(){t.addClass("active");setTimeout(function(){s.addClass("active");n&&n()},600)})})})})},3:function(n){$(".view-3").fadeOut(400,function(){var s=$(".view-4");var r=s.find(".text-1");var q=s.find(".text-2");var p=s.find(".text-3");var o=s.find(".text-4");var x=s.find(".text-5");var w=s.find(".text-6");var v=s.find(".text-7");var u=s.find(".photo-1");var t=s.find(".photo-2");new a(r[0],function(){u.addClass("active");new a(q[0],function(){t.addClass("active");new a(p[0],function(){setTimeout(function(){new a(o[0],function(){new a(x[0],function(){new a(w[0],function(){new a(v[0],function(){n&&n()})})})})},600)})})})})},4:function(n){$(".view-4").fadeOut(400,function(){var o=$(".view-5");var q=o.find(".text-1");var p=o.find(".text-2");var r=o.find(".photo");new a(q[0],function(){new a(p[0],function(){setTimeout(function(){r.each(function(s){var t=$(this);setTimeout(function(){t.addClass("active");if(s===r.length-1){n&&n()}},400*s)})},400)})})})},5:function(n){$(".view-5").fadeOut(400,function(){var o=$(".view-6");var q=o.find(".text-1");var p=o.find(".text-2");var r=o.find(".photo");new a(q[0],function(){r.each(function(s){var t=$(this);setTimeout(function(){t.addClass("active");if(s===r.length-1){new a(p[0],function(){n&&n()})}},600*s)})})})},6:function(n){$(".view-6").fadeOut(400,function(){var o=$(".view-7");var u=o.find(".text-1");var t=o.find(".text-2");var s=o.find(".text-3");var r=o.find(".text-4");var q=o.find(".text-5");var p=o.find(".photo");setTimeout(function(){new a(u[0],function(){setTimeout(function(){p.addClass("active");new a(t[0],function(){new a(s[0],function(){new a(r[0],function(){new a(q[0],function(){n&&n()})})})})},600)})},600)})},7:function(n){$(".view-7").fadeOut(400,function(){var o=$(".view-8");var p=o.find(".text-box");var r=navigator.userAgent.toLowerCase();var q=null;if(r.match(/iphone/i)=="iphone"){q="iphone"}if(r.match(/android/i)=="android"){q="android"}if(q==="iphone"){h();setTimeout(function(){p.fadeIn(600,function(){$(".cake-text").fadeIn()})},6000)}else{$("#cake-a").fadeIn(600);$("#cake-a-text").css({opacity:100}).fadeIn(600);p.fadeIn(600)}})}};function m(){setTimeout(function(){g=false;$("#arrow").fadeIn(600)},1000)}$("#main").swipe({swipeUp:function(o,q,r,p,n){if(g){return}g=true;b++;if(b>=k){return}$("#arrow").fadeOut();e[b](m)}});function f(){var q="loading.jpg gift.png view1-1.jpg view1-2.jpg view1-3.jpg view2-1.jpg view2-2.jpg view2-3.jpg view3-1.jpg view3-2.jpg view4-1.jpg view4-2.jpg view5-1.jpg view5-2.jpg view5-3.jpg view5-4.jpg view6-1.jpg view6-2.jpg view6-3.jpg view7-1.jpg view_bg.jpg cake.jpg".split(" ");var o=0;for(var p=0;p<q.length;p++){var r="./images/"+q[p];var n=new Image();n.src=r;n.onload=function(){o++;$(".loading-text span").html(parseInt(o/q.length*100)+"%");if(o===q.length){setTimeout(function(){l()},2000)}};n.error=function(){$(".loading-text span").html("100%");setTimeout(function(){l()},2000)}}}function l(){c.fadeOut(800,function(){i.fadeIn(800,function(){i.on("touchstart",function(n){d.fadeOut(800,e[0](m));j();i.unbind("touchstart")})})})}function h(){var n=$("#cake-tpl").text();$(".back-cover").append($(n));$(".cake-text").animate({opacity:1})}function a(o,n){this.e=o;if(typeof n==="function"){this.text=o.dataset.text;this.callback=n}else{this.text=o.dataset.text?o.dataset.text:n.text;if(arguments.length>1){this.callback=n.callback?n.callback:false}else{this.callback=false}}this.timer=null;this.len=this.text.length;
this.idx=0;this.time=150;this.tick()}a.prototype.tick=function(){var o=this;if(this.len<=0){return}this.idx++;if(this.idx>this.len){clearTimeout(this.timer);this.timer=null;this.callback&&this.callback();return}var n=this.text.substring(0,this.idx);this.e.innerHTML=n;this.timer=setTimeout(function(){o.tick()},o.time)};function j(){var n=document.getElementById("bgm");n.play()}$("#sound").on("touchstart",function(){var n=document.getElementById("bgm");if(n.paused){n.play();$(this).removeClass("pause")}else{n.pause();$(this).addClass("pause")}});f()});